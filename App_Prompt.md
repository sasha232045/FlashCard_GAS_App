# 依頼概要
あなたはプロのWebアプリケーション開発者です。Google Apps Script(GAS)とGoogleスプレッドシートを用いて、PCとスマートフォンの両方で利用可能な、**科学的学習メソッドと高度なカスタマイズ機能を融合させた、究極の**単語・文章学習Webアプリケーションを開発してください。以下の要件をすべて満たす、完全なソースコード（GASのコード.gs、HTML、CSS、JavaScript）を生成してください。
**デバッグ用に、コンソールの出力は日本語で豊富に行うようにしてください。**
GASのコードはcade.gs, HTMLはindex.html, CSSはstyle.css, JavaScriptはscript.jsに記述してください。

# システム要件
1.  **実行環境**: Google Apps Script (GAS) のWebホスティング機能 (`doGet`) を使用する。
2.  **データベース**: Googleスプレッドシートを使用する。データはすべて単一のスプレッドシート内で管理する。
3.  **UI/UX**:
    *   PCとスマートフォンの両画面に最適化されたレスポンシブデザインを実装する。
    *   CSSとJavaScriptは単一のHTMLファイル内に記述する。
    *   UIは直感的で、モダンかつ学習に集中できるデザインとする。

# スプレッドシート設計案
*   **シート名**: `単語リスト`
*   **列構成**:
    *   A列: `ID` (一意の識別子)
    *   B列: `表面_テキスト` (単語・英文)
    *   C列: `裏面_テキスト` (意味・訳文)
    *   D列: `備考_例文`
    *   E列: `セクション`
    *   F列: `タグ` (カンマ区切り)
    *   G列: `読み上げパターン` (例: E1,J1)
    *   H列: `読み上げ間隔` (秒)
    *   I列: `次回レビュー日` (SRS用)
    *   J列: `間隔` (SRS用日数)
    *   K列: `EF` (SRS用習熟度係数)
    *   L列: `メモ1` (例: カタカナ読み)
    *   M列: `メモ2` (例: 発音記号)
    *   N列: `メモ3` (例: 発音のコツ)
    *   O列: `メモ4` (予備)
    *   P列: `メモ5` (予備)
    *   Q列: `ステータス_Listening`
    *   R列: `ステータス_Reading`
    *   S列: `ステータス_Speaking`
    *   T列: `ステータス_Writing`
    *   U列: `登録日`

# 必須機能一覧

### 1. 基本データ管理
*   **CRUD操作**: 単語・文章の新規登録、編集、削除機能。編集時には、後述するすべての項目（メモ、ステータス等）が変更可能であること。
*   **一覧表示とフィルタリング**:
    *   登録データをテーブル表示。
    *   「セクション」「タグ」に加え、「各種学習ステータス」での絞り込みを可能にする。(例: "Speakingが苦手な単語" のみ表示)

### 2. 高度な読み上げ機能
*   **個別速度設定**: 「表面(英語等)」と「裏面(日本語)」の読み上げ速度をそれぞれ独立して設定可能にする。
*   **カスタム連続読み上げ**: `読み上げパターン`列 (例: `E2,J1,E3`) と`読み上げ間隔`列を解析し、指定通りに再生する。
*   **ループ**:ループのON/OFF
*   **自動再生**:自動的に次の単語を再生する
*   **再生枚数**:10単語ごと、全てなど、連続で学習する枚数を設定できる。

### 3. 発音練習機能 (Speech Recognition)
*   **発音評価モード**: ユーザーの発音を`SpeechRecognition` APIでテキスト化し、正解テキストと比較してフィードバックを表示する。

### 4. 間隔反復システム (SRS)
*   **学習タイミングの最適化**: 単語カード学習後の自己評価（「完璧」「できた」「難しい」等）に基づき、SM-2アルゴリズム等で`次回レビュー日`を自動計算・更新する。「今日復習すべき単語」を簡単に抽出できるようにする。

### 5. 詳細な学習ステータス管理
*   **4技能ステータス**: 各単語に「Listening」「Reading」「Speaking」「Writing」の4つの習得状況を持たせる。
*   **ステータス定義**: 「未着手」「学習中」「苦手・要復習」「定着」「習得済み」の5段階とする。
*   **自動ステータス遷移**:
    1.  **新規登録時**: 4技能すべてのステータスが自動的に「**未着手**」に設定される。
    2.  **初回学習時**: その単語が学習画面で初めて表示された際、4技能すべてのステータスが自動的に「**学習中**」に更新される。
*   **手動ステータス更新**:
    *   学習画面に各技能（L, R, S, W）の現在のステータスを表示する。
    *   このステータス表示はボタンとして機能し、**1回タップするごと**に以下の順で状態が切り替わるようにする:
        `「苦手・要復習」` → `「定着」` → `「習得済み」` → `「苦手・要復習」`に戻る。

### 6. 高度なメモ機能と表示制御
*   **5つのメモ欄**: 各単語に`メモ1`から`メモ5`までの独立したメモ欄を設ける。
*   **表示/非表示のグローバル設定**:
    *   アプリの設定画面（またはヘッダー部分）に、メモの表示を制御するためのトグルスイッチ群を設ける。
    *   以下の10個の表示パターンを個別にON/OFFできるようにする:
        *   `表面（英語）表示時にメモ1を表示する`
        *   `裏面（日本語）表示時にメモ1を表示する`
        *   `表面（英語）表示時にメモ2を表示する`
        *   `裏面（日本語）表示時にメモ2を表示する`
        *   ...以下、メモ5まで同様。
    *   これにより、「英語表示の時は発音記号（メモ2）と発音のコツ（メモ3）だけを表示し、日本語表示の時はカタカナ読み（メモ1）だけを表示する」といった、ユーザーの意図に合わせた柔軟な表示制御を可能にすること。

# 出力形式
1.  **`コード.gs`**: `doGet`関数と、スプレdシートを操作するためのサーバーサイド関数群を実装したGASコード。
2.  **`index.html`**: アプリケーションの骨格となるHTML。レスポンシブ対応CSS、および上記のすべての高度な学習機能を実現するためのクライアントサイドJavaScriptをすべてこのファイルに含めること。

上記のすべての要件を満たし、ユーザーが自身の学習をあらゆる角度からパーソナライズし、最大化できる、完成度の高いアプリケーションのソースコード一式を生成してください。